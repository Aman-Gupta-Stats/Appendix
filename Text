from pyspark.sql.functions import split, col

# Split the tagname by '_', get the third element (index 2)
df_transformed = df.withColumn("after_second_underscore", split(col("tagname"), "_")[2])

# Get distinct values
unique_values = df_transformed.select("after_second_underscore").distinct()

# Show the result
unique_values.show()
